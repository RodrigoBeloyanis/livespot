{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "verdict": {
      "type": "string",
      "enum": ["ALLOW", "BLOCK", "MODIFY"]
    },
    "reasons": {
      "type": "array",
      "items": {"type": "string"},
      "minItems": 1
    },
    "modified_decision": {
      "type": "object"
    }
  },
  "required": ["verdict", "reasons"],
  "if": {
    "properties": {"verdict": {"const": "MODIFY"}}
  },
  "then": {
    "required": ["modified_decision"]
  }
}
